# SEQUENCE

タイトル: Seq-1: 占いMVPフロー（無料・テキスト中心）

User          Telegram         Bot(aiogram)         API(FastAPI)          LLM API          DB
 |               |                  |                    |                   |               |
 |  /start       |                  |                    |                   |               |
 |-------------> |                  |                    |                   |               |
 |               |  Update          |                    |                   |               |
 |               |--------------->  |                    |                   |               |
 |               |                  |  挨拶メッセージ送信 |                   |               |
 |               |  <-------------- |                    |                   |               |
 |  テーマ選択   |                  |                    |                   |               |
 |<------------->|                  |                    |                   |               |
 |               |  Update(テーマ)  |                    |                   |               |
 |               |--------------->  |                    |                   |               |
 |               |                  |  質問入力プロンプト |                   |               |
 |               |  <-------------- |                    |                   |               |
 |  質問入力      |                  |                    |                   |               |
 |-------------> |                  |                    |                   |               |
 |               | Update(質問)     |                    |                   |               |
 |               |--------------->  |                    |                   |               |
 |               |                  |  スプレッド選択案内 |                   |               |
 |               |  <-------------- |                    |                   |               |
 | スプレッド選択|                  |                    |                   |               |
 |-------------> |                  |                    |                   |               |
 |               | Update(選択)     |                    |                   |               |
 |               |--------------->  |                    |                   |               |
 |               |                  |  カード抽選        |                   |               |
 |               |                  |--------------------> (Tarotロジック: メモリ or DB)
 |               |                  |  抽選結果表示      |                   |               |
 |               |  <-------------- |                    |                   |               |
 |               |                  |  POST /api/v1/tarot/reading              |               |
 |               |                  |----------------------------------------->|               |
 |               |                  |                    |   プロンプト生成   |               |
 |               |                  |                    |------------------>|               |
 |               |                  |                    |   返答(解釈文)     |               |
 |               |                  |                    |<------------------|               |
 |               |                  |  DBへセッション/メッセージ保存          |               |
 |               |                  |----------------------------------------->| (insert ...) |
 |               |                  |                    |                   |               |
 |               |  占い結果送信    |                    |                   |               |
 |               |  <-------------- |                    |                   |               |
 |  結果閲覧      |                  |                    |                   |               |
 |               |                  |  再占い/終了ボタン |                   |               |
 |               |  <-------------- |                    |                   |               |
